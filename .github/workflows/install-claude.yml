name: Setup Claude Code CLI with Node Upgrade

on:
  workflow_dispatch:

jobs:
  install-and-verify:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      # [변경됨] Node.js 업그레이드/설정 단계
      # 'lts/*'를 사용하여 항상 최신 LTS(Long Term Support) 버전을 설치합니다.
      # 기존 러너에 구버전이 있더라도 이 단계에서 최신 버전으로 교체(업그레이드)됩니다.
      - name: Upgrade & Setup Node.js (Latest LTS)
        uses: actions/setup-node@v4
        with:
          node-version: 'lts/*' 
          check-latest: true    # 최신 버전인지 온라인 확인 강제

      # 업그레이드 결과 확인 (현재 Node 버전 출력)
      - name: Check Node.js Version
        run: |
          echo "Current Node.js Version:"
          node -v
          echo "Required Version for Claude Code: v18+"

      - name: Install Claude Code CLI
        run: |
          echo "Installing Claude Code..."
          npm install -g @anthropic-ai/claude-code

      - name: Verify Installation
        run: |
          echo "Claude Code CLI Version:"
          claude --version
