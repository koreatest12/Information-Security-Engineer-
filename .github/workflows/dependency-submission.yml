name: Python Dependency Submission

on:
  push:
    branches: [ "main", "master" ]
  pull_request:
    branches: [ "main", "master" ]
  workflow_dispatch:

permissions:
  contents: write

jobs:
  dependency-submission:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          cache: 'pip'

      # 의존성 파일 생성 (필요한 경우)
      - name: Generate requirements
        run: |
          python -m pip install --upgrade pip
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
          # 동적 생성이 필요한 경우 아래 주석 해제
          # pip freeze > requirements.txt

      # [수정됨] 유효한 액션명으로 복구 및 에러 방어 설정
      # 주의: 이 액션은 대용량 파일 다운로드로 인해 'socket hang up'이 간헐적으로 발생할 수 있습니다.
      # continue-on-error: true를 설정하여 제출 실패가 전체 파이프라인을 망치지 않게 합니다.
      - name: Submit Dependency Snapshot
        uses: actions/component-detection-dependency-submission-action@v1
        with:
          fail-on-action-error: false # 에러가 나도 무시하고 진행 (선택 사항)
        continue-on-error: true
